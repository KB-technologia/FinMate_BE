<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="org.finmate.member.mapper.UserInfoMapper">

    <select id="getUserInfoById" resultType="org.finmate.member.domain.UserInfoVO">
        SELECT
            id,
            user_id,
            animal_id,
            exp,
            birth,
            gender,
            is_married,
            has_job,
            uses_public_transport,
            does_exercise,
            travels_frequently,
            has_children,
            has_house ,
            employed_at_sme,
            uses_microloan,
            profile_summary,
            adventure_score,
            value_tag,
            speed_tag,
            strategy_tag,
            finance_score,
            user_level,
            character_ticket,
            updated_at
        FROM user_info
        WHERE user_id = #{userId}
    </select>
    <!-- userinfo 에 설문 결과 저장 -->
    <insert id="insertUserInfo"
            parameterType="org.finmate.member.domain.UserInfoVO"
            useGeneratedKeys="true"
            keyProperty="id"
            keyColumn="id">
        INSERT INTO user_info (
            user_id,
            animal_id,
            exp,
            birth,
            gender,
            is_married,
            has_job,
            uses_public_transport,
            does_exercise,
            travels_frequently,
            has_children,
            has_house,
            employed_at_sme,
            uses_microloan,
            profile_summary,
            adventure_score,
            value_tag,
            speed_tag,
            strategy_tag,
            finance_score,
            user_level,
            character_ticket,
            updated_at
        )
        VALUES (
                   #{userId},
                   #{animalId},
                   #{exp},
                   #{birth},
                   #{gender},
                   #{isMarried},
                   #{hasJob},
                   #{usesPublicTransport},
                   #{doesExercise},
                   #{travelsFrequently},
                   #{hasChildren},
                   #{hasHouse},
                   #{employedAtSme},
                   #{usesMicroloan},
                   #{profileSummary},
                   #{adventureScore},
                   #{valueTag},
                   #{speedTag},
                   #{strategyTag},
                   #{financeScore},
                   #{userLevel},
                   #{characterTicket},
                   #{updatedAt}
               )
            ON DUPLICATE KEY UPDATE
                                 animal_id         = VALUES(animal_id),
                                 exp               = VALUES(exp),
                                 is_married        = VALUES(is_married),
                                 has_job           = VALUES(has_job),
                                 uses_public_transport = VALUES(uses_public_transport),
                                 does_exercise     = VALUES(does_exercise),
                                 travels_frequently = VALUES(travels_frequently),
                                 has_children      = VALUES(has_children),
                                 has_house         = VALUES(has_house),
                                 employed_at_sme   = VALUES(employed_at_sme),
                                 uses_microloan    = VALUES(uses_microloan),
                                 profile_summary   = VALUES(profile_summary),
                                 adventure_score   = VALUES(adventure_score),
                                 value_tag         = VALUES(value_tag),
                                 speed_tag         = VALUES(speed_tag),
                                 strategy_tag      = VALUES(strategy_tag),
                                 finance_score     = VALUES(finance_score),
                                 user_level        = VALUES(user_level),
                                 character_ticket  = VALUES(character_ticket),
                                 updated_at        = NOW()

    </insert>
</mapper>

