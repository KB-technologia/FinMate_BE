<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="org.finmate.member.mapper.UserInfoMapper">

    <select id="getUserInfoById" resultType="org.finmate.member.domain.UserInfoVO">
        SELECT
            id,
            user_id,
            animal_id,
            exp,
            birth,
            gender,
            marital_status,
            has_job,
            uses_public_transport,
            exercises,
            anniversary_frequency,
            travels_frequently,
            number_of_children,
            housing_type,
            employed_at_sme,
            uses_microloan,
            profile_summary,
            adventure_score,
            value_tag,
            speed_tag,
            strategy_tag,
            finance_score,
            updated_at
        FROM user_info
        WHERE id = #{userId}
    </select>
    <!-- userinfo 에 설문 결과 저장 -->
    <insert
            id="insertUserInfo"
            parameterType="org.finmate.member.domain.UserInfoVO"
            useGeneratedKeys="true"
            keyProperty="id"
            keyColumn="id">
        INSERT INTO user_info (
            user_id,
            animal_id,
            exp,
            birth,
            gender,
            marital_status,
            has_job,
            uses_public_transport,
            exercises,
            anniversary_frequency,
            travels_frequently,
            number_of_children,
            housing_type,
            employed_at_sme,
            uses_microloan,
            profile_summary,
            adventure_score,
            value_tag,
            speed_tag,
            strategy_tag,
            finance_score,
            updated_at
        )
        VALUES (
                   #{userId},
                   #{animalId},
                   #{exp},
                   #{birth},
                   #{gender},
                   #{maritalStatus},
                   #{hasJob},
                   #{usesPublicTransport},
                   #{exercises},
                   #{anniversaryFrequency},
                   #{travelsFrequently},
                   #{numberOfChildren},
                   #{housingType},
                   #{employedAtSme},
                   #{usesMicroloan},
                   #{profileSummary},
                   #{adventureScore},
                   #{valueTag},
                   #{speedTag},
                   #{strategyTag},
                   #{financeScore},
                   #{updatedAt}
               )
            ON DUPLICATE KEY UPDATE
                                 animal_id       = VALUES(animal_id),
                                 exp             = VALUES(exp),
                                 marital_status       = VALUES(marital_status),
                                 has_job              = VALUES(has_job),
                                 uses_public_transport  = VALUES(uses_public_transport),
                                 exercises              = VALUES(exercises),
                                 anniversary_frequency  = VALUES(anniversary_frequency),
                                 travels_frequently     = VALUES(travels_frequently),
                                 number_of_children     = VALUES(number_of_children),
                                 housing_type           = VALUES(housing_type),
                                 employed_at_sme        = VALUES(employed_at_sme),
                                 uses_microloan         = VALUES(uses_microloan),
                                 profile_summary = VALUES(profile_summary),
                                 adventure_score = VALUES(adventure_score),
                                 value_tag       = VALUES(value_tag),
                                 speed_tag       = VALUES(speed_tag),
                                 strategy_tag    = VALUES(strategy_tag),
                                 finance_score   = VALUES(finance_score),
                                 updated_at      = NOW()
    </insert>
</mapper>

